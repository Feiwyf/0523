<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>Face Mesh Demo</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background: #222;
    }
    canvas {
      display: block;
      background: #fff;
    }
  </style>
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
  <script>
    let video;
    let faceMesh;
    let predictions = [];
    const indices = [
      409,270,269,267,0,37,39,40,185,61,146,91,181,84,17,314,405,321,375,291,
      76,77,90,180,85,16,315,404,320,307,306,408,304,303,302,11,72,73,74,184
    ];

    function setup() {
      createCanvas(640, 480).parent(document.body);
      video = createCapture(VIDEO);
      video.size(width, height);
      video.hide();
      faceMesh = ml5.facemesh(video, modelReady);
      faceMesh.on('predict', results => predictions = results);
    }

    function modelReady() {
      console.log('FaceMesh ready!');
    }

    function draw() {
      background(255);
      image(video, 0, 0, width, height);

      if (predictions.length > 0) {
        const keypoints = predictions[0].scaledMesh;
        stroke(255, 0, 0);
        strokeWeight(15);
        noFill();
        beginShape();
        for (let i = 0; i < indices.length; i++) {
          const idx = indices[i];
          const [x, y] = keypoints[idx];
          vertex(x, y);
        }
        endShape();
      }
    }
  </script>
</body>
</html>
